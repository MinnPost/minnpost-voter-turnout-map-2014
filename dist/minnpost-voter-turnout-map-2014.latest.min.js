/*! minnpost-voter-turnout-map-2014 - LATEST VERSION - 2014-12-09
* https://github.com/minnpost/minnpost-voter-turnout-map-2014
* Copyright (c) 2014 MinnPost; Licensed MIT */

define("text!../bower.json",[],function(){return'{\n  "name": "minnpost-voter-turnout-map-2014",\n  "version": "0.0.0",\n  "main": "index.html",\n  "homepage": "https://github.com/minnpost/minnpost-voter-turnout-map-2014",\n  "repository": {\n    "type": "git",\n    "url": "https://github.com/minnpost/minnpost-voter-turnout-map-2014"\n  },\n  "bugs": "https://github.com/minnpost/minnpost-voter-turnout-map-2014/issues",\n  "license": "MIT",\n  "author": {\n    "name": "MinnPost",\n    "email": "data@minnpost.com"\n  },\n  "dependencies": {\n    "mapbox.js": "1.x",\n    "ractive": "~0.5.6",\n    "ractive-events-tap": "~0.1.1",\n    "ractive-backbone": "~0.1.1",\n    "requirejs": "~2.1.15",\n    "almond": "~0.3.0",\n    "text": "~2.0.12",\n    "underscore": "~1.7.0",\n    "jquery": "~1.11.1",\n    "backbone": "~1.1.2",\n    "rgrove-lazyload": "*",\n    "minnpost-styles": "master"\n  },\n  "devDependencies": {\n    "qunit": "~1.15.0"\n  },\n  "dependencyMap": {\n    "requirejs": {\n      "rname": "requirejs",\n      "js": [\n        "requirejs/require"\n      ]\n    },\n    "almond": {\n      "rname": "almond",\n      "js": [\n        "almond/almond"\n      ]\n    },\n    "text": {\n      "rname": "text",\n      "js": [\n        "text/text"\n      ]\n    },\n    "jquery": {\n      "rname": "jquery",\n      "js": [\n        "jquery/dist/jquery"\n      ],\n      "returns": "$"\n    },\n    "underscore": {\n      "rname": "underscore",\n      "js": [\n        "underscore/underscore"\n      ],\n      "returns": "_"\n    },\n    "backbone": {\n      "rname": "backbone",\n      "js": [\n        "backbone/backbone"\n      ],\n      "returns": "Backbone"\n    },\n    "rgrove-lazyload": {\n      "rname": "lazyload",\n      "js": [\n        "rgrove-lazyload/lazyload"\n      ],\n      "returns": "Lazyload"\n    },\n    "ractive": {\n      "rname": "ractive",\n      "js": [\n        "ractive/ractive-legacy"\n      ],\n      "returns": "Ractive"\n    },\n    "ractive-backbone": {\n      "rname": "ractive-backbone",\n      "js": [\n        "ractive-backbone/ractive-adaptors-backbone"\n      ],\n      "returns": "RactiveBackbone"\n    },\n    "ractive-events-tap": {\n      "rname": "ractive-events-tap",\n      "js": [\n        "ractive-events-tap/ractive-events-tap"\n      ],\n      "returns": "RactiveEventsTap"\n    },\n    "mapbox.js": {\n      "rname": "mapbox",\n      "js": [\n        "mapbox.js/mapbox.uncompressed"\n      ],\n      "css": [\n        "mapbox.js/mapbox.uncompressed"\n      ],\n      "images": [\n        "mapbox.js/images"\n      ],\n      "returns": "L"\n    },\n    "minnpost-styles": {\n      "rname": "mpStyles",\n      "css": [\n        "//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css",\n        "minnpost-styles/dist/minnpost-styles"\n      ],\n      "sass": [\n        "minnpost-styles/styles/main"\n      ]\n    },\n    "mpConfig": {\n      "rname": "mpConfig",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.config"\n      ],\n      "returns": "mpConfig"\n    },\n    "mpFormatters": {\n      "rname": "mpFormatters",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.formatters"\n      ],\n      "returns": "mpFormatters"\n    },\n    "mpMaps": {\n      "rname": "mpMaps",\n      "js": [\n        "minnpost-styles/dist/minnpost-styles.maps"\n      ],\n      "returns": "mpMaps"\n    }\n  },\n  "resolutions": {\n    "underscore": ">=1.5.0"\n  }\n}\n'}),define("base",["jquery","underscore","backbone","lazyload","mpFormatters","text!../bower.json"],function(a,b,c,d,e,f){var g={};return f=JSON.parse(f),g.BaseApp=function(c){this.options=b.extend(this.baseDefaults||{},this.defaults||{},c||{}),this.name=this.options.name,this.options.el&&(this.el=this.options.el,this.$el=a(this.el),this.$=function(a){return this.$el.find(a)}),this.determinePaths(),this.renderAssests(),this.on("cssLoaded",function(){this.initialize.apply(this,arguments)})},b.extend(g.BaseApp.prototype,c.Events,{bower:f,baseDefaults:{jsonpProxy:"//mp-jsonproxy.herokuapp.com/proxy?url=",availablePaths:{local:{css:[".tmp/css/main.css"],images:"images/",data:"data/"},build:{css:["dist/[[[PROJECT_NAME]]].libs.min.css","dist/[[[PROJECT_NAME]]].latest.min.css"],images:"dist/images/",data:"dist/data/"},deploy:{css:["//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/[[[PROJECT_NAME]]].libs.min.css","//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/[[[PROJECT_NAME]]].latest.min.css"],images:"//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/images/",data:"//s3.amazonaws.com/data.minnpost/projects/[[[PROJECT_NAME]]]/data/"}}},determinePaths:function(){var a;return b.isObject(this.options.paths)&&!b.isUndefined(this.options.deployment)?this.options.paths:(this.options.deployment="deploy",-1!==window.location.host.indexOf("localhost")&&(this.options.deployment="local",a=this.parseQueryString(),b.isObject(a)&&b.isString(a.mpDeployment)&&(this.options.deployment=a.mpDeployment)),this.options.paths=this.options.availablePaths[this.options.deployment],this.options.paths)},renderAssests:function(){var a=this,c=[];b.each(this.bower.dependencyMap,function(d){d.css&&b.each(d.css,function(b){"local"===a.options.deployment?(b=b.match(/^(http|\/\/)/)?b:"bower_components/"+b+".css",c.push(a.makePath(b))):b.match(/^(http|\/\/)/)&&c.push(a.makePath(b))})}),b.each(this.options.paths.css,function(b){c.push(a.makePath(b))}),d.css(c,function(){this.trigger("cssLoaded")},null,this)},makePath:function(a){return a=a.split("[[[PROJECT_NAME]]]").join(this.name),this.options.basePath&&!a.match(/^(http|\/\/)/)&&(a=this.options.basePath+a),a},overrideBackboneAJAX:function(){c.ajax=function(){var a=arguments[0];return a.dataTypeForce!==!0?this.jsonpRequest(a):c.$.ajax.apply(c.$,[a])}},isMSIE:function(){var a=/(msie) ([\w.]+)/i.exec(navigator.userAgent);return a?parseInt(a[2],10):!1},parseQueryString:function(){var a={},c=function(a){return decodeURIComponent(a.replace(/\+/g," "))},d=location.search.substring(1),e=d.split("&");return b.each(e,function(b){var d=b.split("=");d.length>1&&(a[c(d[0])]=c(d[1]))}),a},jsonpRequest:function(b){return b.dataType="jsonp",this.options.jsonpProxy&&-1===b.url.indexOf("callback=")&&(b.jsonpCallback="mpServerSideCachingHelper"+e.hash(b.url),b.url=this.options.jsonpProxy+encodeURIComponent(b.url)+"&callback="+b.jsonpCallback,b.cache=!0),a.ajax.apply(a,[b])},dataRequest:function(c){var d=this,e=!1,f=[];return c=b.isArray(name)?c:[c],0===this.options.paths.data.indexOf("http")&&(e=!0),b.each(c,function(b){var c=e?d.jsonpRequest(d.options.paths.data+b):a.getJSON(d.options.paths.data+b);f.push(c)}),a.when.apply(a,f)},initialize:function(){}}),g.BaseApp.extend=c.Model.extend,g}),define("text!templates/application.mustache",[],function(){return'<div class="application-container">\n  <div class="message-container"></div>\n\n  <div class="content-container">\n\n    <div class="component-label">Voter turnout for the 2014 general election</div>\n\n    <div class="caption">Voter turnout rate calculated by dividing ballots cast by estimated number of citizens who are 18 years and older&dagger;.</div>\n\n    <ul class="legend-container small">\n      {{#legendTurnout}}\n        <li><span class="legend-swatch" style="background-color: {{ color }}"></span> <span class="legend-label">{{ label }}</span></li>\n      {{/legend}}\n    </ul>\n\n    <div class="map" id="voter-turnout-2014"></div>\n\n\n\n    <div class="component-label">Voters per registered for the 2014 general election</div>\n\n    <div class="caption">Voter turnout per number registered rate calculated by dividing ballots cast by estimated number of people registered as of the morning of election day, November 4th, 2015.</div>\n\n    <ul class="legend-container small">\n      {{#legendRegistered}}\n      <li><span class="legend-swatch" style="background-color: {{ color }}"></span> <span class="legend-label">{{ label }}</span></li>\n      {{/legend}}\n    </ul>\n\n    <div class="map" id="voter-turnout-registered-2014"></div>\n  </div>\n\n  <div class="footnote-container">\n    <div class="footnote">\n      <p>&dagger;"Minnesota\'s statewide turnout is officially reported using the eligible voter estimate from the United States Elections Project, which more accurately accounts for all eligibility factors. The data [provided] does not take into account some eligibility factors, and so varies slightly from the official statewide number. For comparison, 2014 statewide turnout is officially 50.51%, versus 51.29% using the data below.  Registration rate data based on number of registrations by start of voting on Election Day, November 4, 2014. It does not include voters who registered on Election Day." (noted from the turnout dataset)</p>\n\n      <p>Voter data from the <a href="http://www.sos.state.mn.us/Modules/ShowDocument.aspx?documentid=14558" target="_blank">MN Secretary of State\'s office</a>.  County boundaries from the <a href="http://www.gis.leg.mn/html/download.html" target="_blank">MN State Legislative Coordinating Commission GIS department</a>.</p>\n\n      <p>Some map data © OpenStreetMap contributors; licensed under the <a href="http://www.openstreetmap.org/copyright" target="_blank">Open Data Commons Open Database License</a>.  Some map design © MapBox; licensed according to the <a href="http://mapbox.com/tos/" target="_blank">MapBox Terms of Service</a>.</p>\n\n      <p>Some code, techniques, and data on <a href="https://github.com/minnpost/minnpost-voter-turnout-map-2014" target="_blank">Github</a>.</p>\n    </div>\n  </div>\n</div>\n'}),define("text!templates/tooltip.underscore",[],function(){return'<div class="inner-tooltip">\n  <div class="component-label"><%= data.COUNTY %></div>\n\n  <div>2008 turnout: <%= format.percent(data.t2008, 1) %></div>\n  <div>2010 turnout: <%= format.percent(data.t2010, 1) %></div>\n  <div>2012 turnout: <%= format.percent(data.t2012, 1) %></div>\n  <div>2014 turnout: <strong><%= format.percent(data.t2014, 1) %></strong></div>\n  <br>\n  <div>2014 voters per number of registered as of the morning of Nov 4th, 2015: <%= format.percent(data.vPerR, 1) %></div>\n</div>\n'}),require(["jquery","underscore","backbone","lazyload","ractive","ractive-backbone","ractive-events-tap","mapbox","mpConfig","mpFormatters","mpMaps","base","text!templates/application.mustache","text!templates/tooltip.underscore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=l.BaseApp.extend({defaults:{name:"minnpost-voter-turnout-map-2014",el:".minnpost-voter-turnout-map-2014-container",mapboxCompTurnout:"minnpost.map-vhjzpwel,minnpost.usbxogvi,minnpost.map-dotjndlk",mapboxCompRegistered:"minnpost.map-vhjzpwel,minnpost.1dvg3nmi,minnpost.map-dotjndlk",mapboxBase:"//{s}.tiles.mapbox.com/v3/",mapboxToken:"pk.eyJ1IjoibWlubnBvc3QiLCJhIjoicUlOUkpvWSJ9.djE93rNktev9eWRJVav6xA"},initialize:function(){var b=this;this.mainView=new e({el:this.$el,template:m,data:{legendTurnout:[{label:"< 45%",color:"#bfdcd9"},{label:"45 - 50%",color:"#7cb8c5"},{label:"50 - 55%",color:"#4691ba"},{label:"55 - 60%",color:"#3c64a7"},{label:">= 60%",color:"#55307e"}],legendRegistered:[{label:"< 60%",color:"#d6e6ce"},{label:"60 - 65%",color:"#c4c693"},{label:"65 - 70%",color:"#c2a25c"},{label:"70 - 75%",color:"#c67736"},{label:">= 75%",color:"#c83d2d"}]},partials:{}}),a.ajax({url:this.options.mapboxBase.replace("{s}","a")+this.options.mapboxCompTurnout+".json?callback=?",dataType:"jsonp",cache:!0,success:function(c){b.tilejsonTurnout=c,a.ajax({url:b.options.mapboxBase.replace("{s}","a")+b.options.mapboxCompRegistered+".json?callback=?",dataType:"jsonp",cache:!0,success:function(a){b.tilejsonRegistered=a,b.makeMaps()}})}})},makeMaps:function(){h.mapbox.accessToken=this.options.mapboxToken,this.mapTurnout=h.mapbox.map("voter-turnout-2014",this.tilejsonTurnout,{scrollWheelZoom:!1,trackResize:!0,minZoom:6,maxZoom:12}),this.mapTurnout.setView(k.minnesotaPoint),this.mapTurnout.removeControl(this.mapTurnout.attributionControl),this.mapTurnout.gridControl._template=function(a,c){if(c){var d=this.options.template||this._layer.getTileJSON().template;return d?this.options.sanitizer(b.template(d)({format:j,data:c})):void 0}},this.mapTurnout.gridControl.setTemplate(n),this.mapTurnout.gridControl.options.pinnable=!1,this.mapRegistered=h.mapbox.map("voter-turnout-registered-2014",this.tilejsonRegistered,{scrollWheelZoom:!1,trackResize:!0,minZoom:6,maxZoom:12}),this.mapRegistered.setView(k.minnesotaPoint),this.mapRegistered.removeControl(this.mapRegistered.attributionControl),this.mapRegistered.gridControl._template=function(a,c){if(c){var d=this.options.template||this._layer.getTileJSON().template;return d?this.options.sanitizer(b.template(d)({format:j,data:c})):void 0}},this.mapRegistered.gridControl.setTemplate(n),this.mapRegistered.gridControl.options.pinnable=!1}});return new o({})}),define("app",function(){});